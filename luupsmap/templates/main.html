{% extends 'index.html' %}

{% block header_controls %}
  <div class="media flt--right" onclick="showModal(true)">
    <a class="cta">
      <svg viewBox="0 0 24 24">
        <use xlink:href="{{ url_for('static', filename='svg/icons/all.svg') }}#search"></use>
      </svg>
    </a>
  </div>
{% endblock %}

{% block content %}
  <div id="overlay" class="overlay">
    <div id="modal" class="modal">
      <form action="" method="post">
        <header class="modal-header">
          <a class="close flt--right" onclick="showModal(false)">&times;</a>
        </header>
        <div class="content">
          <h3 class="content-header">Nach Art filtern</h3>
          <div class="type-container">
            {%  for type in types %}
              <label class="check type">
                <input type="checkbox" name="{{ type }}" checked>
                <div class="box icon-container {{ type }}">
                  <svg viewBox="0 0 24 24" class="{{ type }}">
                    <use xlink:href="{{ url_for('static', filename='svg/icons/all.svg') }}#{{ type }}"></use>
                  </svg>
                </div>
              </label>
            {% endfor %}
          </div>
          <h3 class="content-header">Nach Tag filtern</h3>
          <div class="tag-container">
            {% for tag in tags %}
              <label class="check">
                <input type="checkbox" name="{{ tag }}">
                <div class="tag">
                  {{ tag }}
                </div>
              </label>
            {% endfor %}
          </div>
        </div>
        <footer class="modal-footer ">
          <input type="submit" value="Submit" class="btn--green">
        </footer>
      </form>
    </div>
  </div>
  <section id="map" class="map">
    <div id="content"></div>
  </section>
  <!-- GOOGLE MAPS -->
  <script src="https://maps.googleapis.com/maps/api/js?key={{ config.GMAPS_API_KEY }}"></script>
  <script>
    initMap();
    {% for venue in venues %}
      {% for location in venue.locations %}
        {# TODO: Proper JSON serisalization #}
        venue_dict = {
          id: '{{ venue.id  }}',
          name: '{{ venue.name | escape }}',
          homepage: '{{ venue.homepage }}',
          type: '{{ venue.type}}',
          href: '{{ url_for('show_details', venue_id=venue.id) }}'
        };
        addMarker(venue_dict, {
          lat: {{ location.latitude }},
          lng: {{ location.longitude }}
        });
      {% endfor %}
    {% endfor %}
  </script>
{% endblock %}
